# Gateway, Subnet

Local Network는 ARP 브로드 캐스트를 이용해서 MAC주소를 학습할 수 있고 이 MAC을 통해 직접 통신도 가능하다.

반면 Remote Network는 통신할 때 네트워크를 넘어 전달되지 못하는 브로드 캐스트의 성질 때문에 다른 네트워크 장비의 도움이 필요하다.

이 장비를 **Gateway**라고 하고 게이트웨이에 대한 정보를 pc, network 장비에게 설정하는 항목이 default gateway라는 옵션이다.

기본 게이트웨이는 3계층 장비가 수행하고 여러 네트워크와 연결되면서 적절한 경로를 지정해주는 역할을 한다.

출발지와 목적지 네트워크가 동일한 lan에서 통신하는 것인지 서로 다른 네트워크간의 통신하는 것인지 확인하기 위해서 출발지에서는 먼저 목적지가 자신이 속한 네트워크 범위인지를 체크해야한다. 이때 사용되는 범위 정보가 바로 **Subnet Mask**다.
- 동일 네트워크 간의 통신과 다른 네트워크 간의 통신은 방식과 장비의 차이가 있다.
- 로컬 통신은 ARP 요청으로 목적지를 찾아 통신할 수 있지만 원격 통신은 라우터를 넘어가지 못하는 브로드 캐스트를 위해 외부와 통신 가능한 장비의 도움이 필요하다.
- **출발지와 목적지가 같은 네트워크인지를 확인하기 위해 사용되는 것이 서브넷 마스크다.** 즉 ip 주소의 네트워크 부분과 호스트 부분을 구분하기도 하며 식별할 수도 있는 것이다.

<br>

### Proxy ARP

proxy arp는 arp를 대행해주는 기능으로 원격 통신은 기본 게이트웨이를 찾은 arp를 보내고 패킷을 기본 게이트웨이 쪽으로 보내야만 통신이 가능하다.

그러나 기본 게이트웨이에 프록시 arp가 활성화 되었다면 원격지라도 로컬에 arp 브로드 캐스트를 보낼 수가 있다.
- 프록시 arp가 활성된 기본 게이트웨이(라우터)는 arp 브로드캐스트가 들어오면 자신이 대행 arp 응답을 해준다.
- 이 경우, 패킷이 기본 게이트웨이 쪽으로 보내지므로 원격지 경로를 전달될 수 있다.

proxy arp 기능은 라우터에 기본으로 활성화되어 있어, 사용자 몰래 동작하는 경우가 많다,

하지만 네트워크 설정 오류가 있거나 꼭 입력해야할 설정이 되어 있지 않아도 동작하는 경우가 있어 장애가 발생했을 때 쉽게 해결할 수 없게 만드는 **장애 요소**가 되기도 한다.


